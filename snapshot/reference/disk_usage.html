
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Axon Avro is a set of libraries allowing for effective use of Apache Avro for serialization and de-serialization of Axon Messages.">
      
      
        <meta name="author" content="Holisticon Event Sourcerers">
      
      
        <link rel="canonical" href="https://www.holixon.io/axon-avro/snapshot/reference/disk_usage.html">
      
      
        <link rel="prev" href="index.html">
      
      
        <link rel="next" href="../developer-guide/contribution.html">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.39">
    
    
      
        <title>Disk Usage - Axon Avro</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#test-setup" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="Axon Avro" class="md-header__button md-logo" aria-label="Axon Avro" data-md-component="logo">
      
  <img src="../assets/img/holixon-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Axon Avro
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Disk Usage
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/holixon/axon-avro/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    holixon/axon-avro
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../motivation.html" class="md-tabs__link">
        
  
    
  
  Motivation

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../features/serializer.html" class="md-tabs__link">
          
  
  Features

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="index.html" class="md-tabs__link">
          
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../developer-guide/contribution.html" class="md-tabs__link">
          
  
  Developer Guide

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Axon Avro" class="md-nav__button md-logo" aria-label="Axon Avro" data-md-component="logo">
      
  <img src="../assets/img/holixon-logo.png" alt="logo">

    </a>
    Axon Avro
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/holixon/axon-avro/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    holixon/axon-avro
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../motivation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Motivation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Features
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/serializer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Avro Axon Serializer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/server-plugin.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Avro Axon Server Plugin
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to use
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Disk Usage
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="disk_usage.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Disk Usage
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#test-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Test setup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-results" class="md-nav__link">
    <span class="md-ellipsis">
      Test results
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Test results">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xstream" class="md-nav__link">
    <span class="md-ellipsis">
      XStream
    </span>
  </a>
  
    <nav class="md-nav" aria-label="XStream">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#timings" class="md-nav__link">
    <span class="md-ellipsis">
      Timings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk-space-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Disk space usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#representation-in-the-event-store" class="md-nav__link">
    <span class="md-ellipsis">
      Representation in the event store
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jackson-json" class="md-nav__link">
    <span class="md-ellipsis">
      Jackson JSON
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Jackson JSON">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#timings_1" class="md-nav__link">
    <span class="md-ellipsis">
      Timings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Disk usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jackson-cbor" class="md-nav__link">
    <span class="md-ellipsis">
      Jackson CBOR
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Jackson CBOR">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#timings_2" class="md-nav__link">
    <span class="md-ellipsis">
      Timings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk-usage_1" class="md-nav__link">
    <span class="md-ellipsis">
      Disk usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avro-with-java-generated-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Avro with Java generated classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Avro with Java generated classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#timings_3" class="md-nav__link">
    <span class="md-ellipsis">
      Timings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk-usage_2" class="md-nav__link">
    <span class="md-ellipsis">
      Disk usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avro-with-kotlinx-serialized-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Avro with KotlinX serialized classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Avro with KotlinX serialized classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#timings_4" class="md-nav__link">
    <span class="md-ellipsis">
      Timings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk-usage_3" class="md-nav__link">
    <span class="md-ellipsis">
      Disk usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-compare-anatomy-of-the-test-application" class="md-nav__link">
    <span class="md-ellipsis">
      How to compare / anatomy of the test application
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-tests-on-your-own" class="md-nav__link">
    <span class="md-ellipsis">
      Run tests on your own
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-test-run" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Test run
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developer Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Developer Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developer-guide/contribution.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developer-guide/project-setup.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project Setup
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Disk Usage</h1>

<p>If your application is using Event Sourcing as persistence strategy, the total disk space usage of your event store and the serialization 
speed might be an interesting parameters. Assuming that you are using some event store technology (Axon Server or any other Event Store of your choice), 
this values depends on the serialization format. Currently, Axon Framework supports the following serialization formats: Java Binary, JSON via Jackson, 
CBOR via Jackson and XML via XStream. If you are planing to use this extension, you are extending this list by Avro Single Object Encoded.</p>
<p>In order to use Avro Encoding, you have to rely on either KotlinX Serialization based on avro4k or on Avro Java library using a generator creating
you classes from you Avro schema which are subclassing <code>SpecificRecordBase</code>.</p>
<p>In this section, we publish results we conducted during comparison of the formats above. Since Java Binary serialization should not be used
in any productive systems due to security considerations, we excluded it from the test and conducted comparison on XML, JSON, CBOR and Avro.</p>
<h2 id="test-setup">Test setup<a class="headerlink" href="#test-setup" title="Permanent link">#</a></h2>
<ul>
<li>Created a small banking application, allowing to create account and deposit and withdraw money. It consists of three commands, one aggregate,
  three events and a projection.</li>
<li>The application has an API to batch creation of accounts and executing operations on them</li>
<li>For every account, we executed money transfer operations in pairs (withdraws, disposals)</li>
<li>Results in 2 * M + 1 events per account</li>
<li>Running with N=10 accounts, M=100 operation pairs, resulting in 10 * 201 = 2010 events per run</li>
<li>The total test was to execute 5 runs resulting in 10050 events in the Axon Server</li>
<li>For Axon Server we used a docker-version version <code>axoniq/axonserver:2023.2.6-jdk-17</code> with small event segment files 977kb (1000000 bytes)</li>
<li>The test application and Axon Server were running on the same machine</li>
<li>Measured time for each run (The test was executed on Ubuntu 22.04.4 LTS running on a Lenovo P1 with Intel® Core™ i7-8850H CPU @ 2.60GHz × 12, 32,0 GiB, SSD M.2 PCIe NVMe)</li>
<li>Checked file system and calculate storage requirements</li>
<li>We intentionally used a special type (<code>Money</code>) to simulate a slightly more complex scenario than just plain events with native types supported by any format</li>
</ul>
<h2 id="test-results">Test results<a class="headerlink" href="#test-results" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>Format</th>
<th>Average run (ms)</th>
<th>Time Factor</th>
<th>Average Event size (bytes)</th>
<th>Size Factor</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>XStream</td>
<td>40381</td>
<td>1.588</td>
<td>1340</td>
<td>4.253</td>
<td>No additional configuration.</td>
</tr>
<tr>
<td>Jackson JSON</td>
<td>25456</td>
<td>1.001</td>
<td>355</td>
<td>1.227</td>
<td>Custom Object Mapper settings for Money.</td>
</tr>
<tr>
<td>Jackson CBOR</td>
<td>25423</td>
<td>1.000</td>
<td>344</td>
<td>1.092</td>
<td>Custom Object Mapper settings for Money.</td>
</tr>
<tr>
<td>Avro KotlinX</td>
<td>82162</td>
<td>3.232</td>
<td>315</td>
<td>1.000</td>
<td>Custom type conversions for Money.</td>
</tr>
<tr>
<td>Avro Java</td>
<td>136087</td>
<td>5.323</td>
<td>315</td>
<td>1.000</td>
<td>Custom type conversions for Money.</td>
</tr>
</tbody>
</table>
<p>For Avro we were using Single Object Encoded format (binary format with schema reference) for both KotlinX Serialized and Java generated 
(<code>SpecificRecordBase</code>) classes. This results in the identical representation (with same disk space consumption). </p>
<p>You can find the detailed information about the test runs below.</p>
<h3 id="xstream">XStream<a class="headerlink" href="#xstream" title="Permanent link">#</a></h3>
<h4 id="timings">Timings<a class="headerlink" href="#timings" title="Permanent link">#</a></h4>
<ol>
<li>Time: 40690ms</li>
<li>Time: 40438ms</li>
<li>Time: 40162ms</li>
<li>Time: 40310ms</li>
<li>Time: 40308ms</li>
</ol>
<p>Resulting in an average of 40381ms.</p>
<h4 id="disk-space-usage">Disk space usage<a class="headerlink" href="#disk-space-usage" title="Permanent link">#</a></h4>
<div class="highlight"><pre><span></span><code>-rw-r--r-- 1 root root 1000000 Jul 12 22:46 00000000000000000000.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:47 00000000000000000746.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:47 00000000000000001492.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:48 00000000000000002238.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:48 00000000000000002984.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:48 00000000000000003730.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:49 00000000000000004476.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:49 00000000000000005222.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:50 00000000000000005968.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:50 00000000000000006714.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:50 00000000000000007460.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:51 00000000000000008206.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:51 00000000000000008952.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:51 00000000000000009698.events
</code></pre></div>
<h4 id="representation-in-the-event-store">Representation in the event store<a class="headerlink" href="#representation-in-the-event-store" title="Permanent link">#</a></h4>
<p>Just for reference, this is how it would look like if we are not using Moneta library, but just encode amount as Integer.</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;bankaccount.event.BankAccountCreated&gt;</span>
<span class="w">  </span><span class="nt">&lt;accountId&gt;</span>55eeba20-cdae-40fd-b418-b0f7b38cb676<span class="nt">&lt;/accountId&gt;</span>
<span class="w">  </span><span class="nt">&lt;initialBalance&gt;</span>100<span class="nt">&lt;/initialBalance&gt;</span>
<span class="nt">&lt;/bankaccount.event.BankAccountCreated&gt;</span>
</code></pre></div>
<p>BankAccountCreated:
<div class="highlight"><pre><span></span><code><span class="nt">&lt;bankaccount.event.BankAccountCreated&gt;</span>
<span class="w">  </span><span class="nt">&lt;accountId&gt;</span>bda57038-0f52-46aa-ab1f-8ee4d0b81768<span class="nt">&lt;/accountId&gt;</span>
<span class="w">  </span><span class="nt">&lt;initialBalance&gt;</span>
<span class="w">    </span><span class="nt">&lt;currency</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;org.javamoney.moneta.spi.JDKCurrencyAdapter&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;baseCurrency&gt;</span>EUR<span class="nt">&lt;/baseCurrency&gt;</span>
<span class="w">      </span><span class="nt">&lt;context&gt;</span>
<span class="w">        </span><span class="nt">&lt;data&gt;</span>
<span class="w">          </span><span class="nt">&lt;entry&gt;</span>
<span class="w">            </span><span class="nt">&lt;string&gt;</span>provider<span class="nt">&lt;/string&gt;</span>
<span class="w">            </span><span class="nt">&lt;string&gt;</span>java.util.Currency<span class="nt">&lt;/string&gt;</span>
<span class="w">          </span><span class="nt">&lt;/entry&gt;</span>
<span class="w">        </span><span class="nt">&lt;/data&gt;</span>
<span class="w">      </span><span class="nt">&lt;/context&gt;</span>
<span class="w">    </span><span class="nt">&lt;/currency&gt;</span>
<span class="w">    </span><span class="nt">&lt;monetaryContext&gt;</span>
<span class="w">      </span><span class="nt">&lt;data&gt;</span>
<span class="w">        </span><span class="nt">&lt;entry&gt;</span>
<span class="w">          </span><span class="nt">&lt;string&gt;</span>amountType<span class="nt">&lt;/string&gt;</span>
<span class="w">          </span><span class="nt">&lt;java-class&gt;</span>org.javamoney.moneta.Money<span class="nt">&lt;/java-class&gt;</span>
<span class="w">        </span><span class="nt">&lt;/entry&gt;</span>
<span class="w">        </span><span class="nt">&lt;entry&gt;</span>
<span class="w">          </span><span class="nt">&lt;string&gt;</span>precision<span class="nt">&lt;/string&gt;</span>
<span class="w">          </span><span class="nt">&lt;int&gt;</span>256<span class="nt">&lt;/int&gt;</span>
<span class="w">        </span><span class="nt">&lt;/entry&gt;</span>
<span class="w">        </span><span class="nt">&lt;entry&gt;</span>
<span class="w">          </span><span class="nt">&lt;string&gt;</span>java.lang.Class<span class="nt">&lt;/string&gt;</span>
<span class="w">          </span><span class="nt">&lt;java-class&gt;</span>org.javamoney.moneta.Money<span class="nt">&lt;/java-class&gt;</span>
<span class="w">        </span><span class="nt">&lt;/entry&gt;</span>
<span class="w">        </span><span class="nt">&lt;entry&gt;</span>
<span class="w">          </span><span class="nt">&lt;string&gt;</span>java.math.RoundingMode<span class="nt">&lt;/string&gt;</span>
<span class="w">          </span><span class="nt">&lt;java.math.RoundingMode&gt;</span>HALF_EVEN<span class="nt">&lt;/java.math.RoundingMode&gt;</span>
<span class="w">        </span><span class="nt">&lt;/entry&gt;</span>
<span class="w">      </span><span class="nt">&lt;/data&gt;</span>
<span class="w">    </span><span class="nt">&lt;/monetaryContext&gt;</span>
<span class="w">    </span><span class="nt">&lt;number&gt;</span>100<span class="nt">&lt;/number&gt;</span>
<span class="w">  </span><span class="nt">&lt;/initialBalance&gt;</span>
<span class="nt">&lt;/bankaccount.event.BankAccountCreated&gt;</span>
</code></pre></div></p>
<p>MoneyDeposited
<div class="highlight"><pre><span></span><code><span class="nt">&lt;bankaccount.event.MoneyDeposited&gt;</span>
<span class="w">  </span><span class="nt">&lt;accountId&gt;</span>bda57038-0f52-46aa-ab1f-8ee4d0b81768<span class="nt">&lt;/accountId&gt;</span>
<span class="w">  </span><span class="nt">&lt;amount&gt;</span>
<span class="w">    </span><span class="nt">&lt;currency</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;org.javamoney.moneta.spi.JDKCurrencyAdapter&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;baseCurrency&gt;</span>EUR<span class="nt">&lt;/baseCurrency&gt;</span>
<span class="w">      </span><span class="nt">&lt;context&gt;</span>
<span class="w">        </span><span class="nt">&lt;data&gt;</span>
<span class="w">          </span><span class="nt">&lt;entry&gt;</span>
<span class="w">            </span><span class="nt">&lt;string&gt;</span>provider<span class="nt">&lt;/string&gt;</span>
<span class="w">            </span><span class="nt">&lt;string&gt;</span>java.util.Currency<span class="nt">&lt;/string&gt;</span>
<span class="w">          </span><span class="nt">&lt;/entry&gt;</span>
<span class="w">        </span><span class="nt">&lt;/data&gt;</span>
<span class="w">      </span><span class="nt">&lt;/context&gt;</span>
<span class="w">    </span><span class="nt">&lt;/currency&gt;</span>
<span class="w">    </span><span class="nt">&lt;monetaryContext&gt;</span>
<span class="w">      </span><span class="nt">&lt;data&gt;</span>
<span class="w">        </span><span class="nt">&lt;entry&gt;</span>
<span class="w">          </span><span class="nt">&lt;string&gt;</span>amountType<span class="nt">&lt;/string&gt;</span>
<span class="w">          </span><span class="nt">&lt;java-class&gt;</span>org.javamoney.moneta.Money<span class="nt">&lt;/java-class&gt;</span>
<span class="w">        </span><span class="nt">&lt;/entry&gt;</span>
<span class="w">        </span><span class="nt">&lt;entry&gt;</span>
<span class="w">          </span><span class="nt">&lt;string&gt;</span>precision<span class="nt">&lt;/string&gt;</span>
<span class="w">          </span><span class="nt">&lt;int&gt;</span>256<span class="nt">&lt;/int&gt;</span>
<span class="w">        </span><span class="nt">&lt;/entry&gt;</span>
<span class="w">        </span><span class="nt">&lt;entry&gt;</span>
<span class="w">          </span><span class="nt">&lt;string&gt;</span>java.lang.Class<span class="nt">&lt;/string&gt;</span>
<span class="w">          </span><span class="nt">&lt;java-class&gt;</span>org.javamoney.moneta.Money<span class="nt">&lt;/java-class&gt;</span>
<span class="w">        </span><span class="nt">&lt;/entry&gt;</span>
<span class="w">        </span><span class="nt">&lt;entry&gt;</span>
<span class="w">          </span><span class="nt">&lt;string&gt;</span>java.math.RoundingMode<span class="nt">&lt;/string&gt;</span>
<span class="w">          </span><span class="nt">&lt;java.math.RoundingMode&gt;</span>HALF_EVEN<span class="nt">&lt;/java.math.RoundingMode&gt;</span>
<span class="w">        </span><span class="nt">&lt;/entry&gt;</span>
<span class="w">      </span><span class="nt">&lt;/data&gt;</span>
<span class="w">    </span><span class="nt">&lt;/monetaryContext&gt;</span>
<span class="w">    </span><span class="nt">&lt;number&gt;</span>19<span class="nt">&lt;/number&gt;</span>
<span class="w">  </span><span class="nt">&lt;/amount&gt;</span>
<span class="nt">&lt;/bankaccount.event.MoneyDeposited&gt;</span>
</code></pre></div></p>
<p>MoneyWithdrawn
<div class="highlight"><pre><span></span><code><span class="nt">&lt;bankaccount.event.MoneyWithdrawn&gt;</span>
<span class="w">  </span><span class="nt">&lt;accountId&gt;</span>bda57038-0f52-46aa-ab1f-8ee4d0b81768<span class="nt">&lt;/accountId&gt;</span>
<span class="w">  </span><span class="nt">&lt;amount&gt;</span>
<span class="w">    </span><span class="nt">&lt;currency</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;org.javamoney.moneta.spi.JDKCurrencyAdapter&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;baseCurrency&gt;</span>EUR<span class="nt">&lt;/baseCurrency&gt;</span>
<span class="w">      </span><span class="nt">&lt;context&gt;</span>
<span class="w">        </span><span class="nt">&lt;data&gt;</span>
<span class="w">          </span><span class="nt">&lt;entry&gt;</span>
<span class="w">            </span><span class="nt">&lt;string&gt;</span>provider<span class="nt">&lt;/string&gt;</span>
<span class="w">            </span><span class="nt">&lt;string&gt;</span>java.util.Currency<span class="nt">&lt;/string&gt;</span>
<span class="w">          </span><span class="nt">&lt;/entry&gt;</span>
<span class="w">        </span><span class="nt">&lt;/data&gt;</span>
<span class="w">      </span><span class="nt">&lt;/context&gt;</span>
<span class="w">    </span><span class="nt">&lt;/currency&gt;</span>
<span class="w">    </span><span class="nt">&lt;monetaryContext&gt;</span>
<span class="w">      </span><span class="nt">&lt;data&gt;</span>
<span class="w">        </span><span class="nt">&lt;entry&gt;</span>
<span class="w">          </span><span class="nt">&lt;string&gt;</span>amountType<span class="nt">&lt;/string&gt;</span>
<span class="w">          </span><span class="nt">&lt;java-class&gt;</span>org.javamoney.moneta.Money<span class="nt">&lt;/java-class&gt;</span>
<span class="w">        </span><span class="nt">&lt;/entry&gt;</span>
<span class="w">        </span><span class="nt">&lt;entry&gt;</span>
<span class="w">          </span><span class="nt">&lt;string&gt;</span>precision<span class="nt">&lt;/string&gt;</span>
<span class="w">          </span><span class="nt">&lt;int&gt;</span>256<span class="nt">&lt;/int&gt;</span>
<span class="w">        </span><span class="nt">&lt;/entry&gt;</span>
<span class="w">        </span><span class="nt">&lt;entry&gt;</span>
<span class="w">          </span><span class="nt">&lt;string&gt;</span>java.lang.Class<span class="nt">&lt;/string&gt;</span>
<span class="w">          </span><span class="nt">&lt;java-class&gt;</span>org.javamoney.moneta.Money<span class="nt">&lt;/java-class&gt;</span>
<span class="w">        </span><span class="nt">&lt;/entry&gt;</span>
<span class="w">        </span><span class="nt">&lt;entry&gt;</span>
<span class="w">          </span><span class="nt">&lt;string&gt;</span>java.math.RoundingMode<span class="nt">&lt;/string&gt;</span>
<span class="w">          </span><span class="nt">&lt;java.math.RoundingMode&gt;</span>HALF_EVEN<span class="nt">&lt;/java.math.RoundingMode&gt;</span>
<span class="w">        </span><span class="nt">&lt;/entry&gt;</span>
<span class="w">      </span><span class="nt">&lt;/data&gt;</span>
<span class="w">    </span><span class="nt">&lt;/monetaryContext&gt;</span>
<span class="w">    </span><span class="nt">&lt;number&gt;</span>9<span class="nt">&lt;/number&gt;</span>
<span class="w">  </span><span class="nt">&lt;/amount&gt;</span>
<span class="nt">&lt;/bankaccount.event.MoneyWithdrawn&gt;</span>
</code></pre></div></p>
<h3 id="jackson-json">Jackson JSON<a class="headerlink" href="#jackson-json" title="Permanent link">#</a></h3>
<h4 id="timings_1">Timings<a class="headerlink" href="#timings_1" title="Permanent link">#</a></h4>
<ol>
<li>Time: 25297ms</li>
<li>Time: 25351ms</li>
<li>Time: 25070ms</li>
<li>Time: 25425ms</li>
<li>Time: 26140ms</li>
</ol>
<p>Resulting in an average of 25456ms.</p>
<h4 id="disk-usage">Disk usage<a class="headerlink" href="#disk-usage" title="Permanent link">#</a></h4>
<div class="highlight"><pre><span></span><code>-rw-r--r-- 1 root root 1000000 Jul 12 22:25 00000000000000000000.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:26 00000000000000002817.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:29 00000000000000005634.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:29 00000000000000008451.events
</code></pre></div>
<p>In order to be able to serialize Money type, an additional <code>jackson-datatype-money</code> library was required
and the corresponding module needed to be registered. </p>
<p>BankAccountCreated:
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;accountId&quot;</span><span class="p">:</span><span class="s2">&quot;702bdae0-d507-4664-8ee8-d8d7e3ff5778&quot;</span><span class="p">,</span><span class="nt">&quot;initialBalance&quot;</span><span class="p">:{</span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="mf">100.00</span><span class="p">,</span><span class="nt">&quot;currency&quot;</span><span class="p">:</span><span class="s2">&quot;EUR&quot;</span><span class="p">}}</span>
</code></pre></div>
MoneyDeposited:
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;accountId&quot;</span><span class="p">:</span><span class="s2">&quot;702bdae0-d507-4664-8ee8-d8d7e3ff5778&quot;</span><span class="p">,</span><span class="nt">&quot;amount&quot;</span><span class="p">:{</span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="mf">19.00</span><span class="p">,</span><span class="nt">&quot;currency&quot;</span><span class="p">:</span><span class="s2">&quot;EUR&quot;</span><span class="p">}}</span>
</code></pre></div>
MoneyWithdrawn:
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;accountId&quot;</span><span class="p">:</span><span class="s2">&quot;702bdae0-d507-4664-8ee8-d8d7e3ff5778&quot;</span><span class="p">,</span><span class="nt">&quot;amount&quot;</span><span class="p">:{</span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="mf">10.00</span><span class="p">,</span><span class="nt">&quot;currency&quot;</span><span class="p">:</span><span class="s2">&quot;EUR&quot;</span><span class="p">}}</span>
</code></pre></div></p>
<h2 id="jackson-cbor">Jackson CBOR<a class="headerlink" href="#jackson-cbor" title="Permanent link">#</a></h2>
<h4 id="timings_2">Timings<a class="headerlink" href="#timings_2" title="Permanent link">#</a></h4>
<ol>
<li>Time: 26427ms</li>
<li>Time: 25224ms</li>
<li>Time: 25002ms</li>
<li>Time: 25120ms</li>
<li>Time: 25343ms</li>
</ol>
<p>Resulting in an average of 25423ms.</p>
<h4 id="disk-usage_1">Disk usage<a class="headerlink" href="#disk-usage_1" title="Permanent link">#</a></h4>
<p><div class="highlight"><pre><span></span><code>-rw-r--r-- 1 root root 1000000 Jul 12 22:13 00000000000000000000.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:17 00000000000000002904.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:18 00000000000000005808.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:18 00000000000000008712.events
</code></pre></div>
In order to be able to serialize Money type, an additional <code>jackson-datatype-money</code> library was required
and the corresponding module needed to be registered.</p>
<p>BankAccountCreated
<div class="highlight"><pre><span></span><code>�iaccountIdx$9b4b8c26-d16f-4ce3-b5ab-62beb9b711d1ninitialBalance�famountĂ!&#39;hcurrencycEUR��
</code></pre></div></p>
<p>MoneyDeposited
<div class="highlight"><pre><span></span><code>�iaccountIdx$9b4b8c26-d16f-4ce3-b5ab-62beb9b711d1famount�famountĂ!�hcurrencycEUR��
</code></pre></div></p>
<p>MoneyWithdrawn
<div class="highlight"><pre><span></span><code>�iaccountIdx$9b4b8c26-d16f-4ce3-b5ab-62beb9b711d1famount�famountĂ!�hcurrencycEUR��
</code></pre></div></p>
<h3 id="avro-with-java-generated-classes">Avro with Java generated classes<a class="headerlink" href="#avro-with-java-generated-classes" title="Permanent link">#</a></h3>
<h4 id="timings_3">Timings<a class="headerlink" href="#timings_3" title="Permanent link">#</a></h4>
<ol>
<li>Time: 135915ms</li>
<li>Time: 136152ms</li>
<li>Time: 136598ms</li>
<li>Time: 135525ms</li>
<li>Time: 136245ms</li>
</ol>
<p>Resulting in an average of 136087ms.</p>
<h4 id="disk-usage_2">Disk usage<a class="headerlink" href="#disk-usage_2" title="Permanent link">#</a></h4>
<div class="highlight"><pre><span></span><code>-rw-r--r-- 1 root root 1000000 Jul 12 23:37 00000000000000000000.events
-rw-r--r-- 1 root root 1000000 Jul 12 23:42 00000000000000003165.events
-rw-r--r-- 1 root root 1000000 Jul 12 23:46 00000000000000006330.events
-rw-r--r-- 1 root root 1000000 Jul 12 23:47 00000000000000009495.events
</code></pre></div>
<p>BankAccountCreated
<div class="highlight"><pre><span></span><code>�K��X{lH27cd7b01-1515-4d4f-998e-4df0e08e44a7100,00 EUR
</code></pre></div></p>
<p>MoneyDeposited
<div class="highlight"><pre><span></span><code>�mN;�Z�ӦH27cd7b01-1515-4d4f-998e-4df0e08e44a712,00 EUR
</code></pre></div></p>
<p>MoneyWithdrawn
<div class="highlight"><pre><span></span><code>�VFtDj�xH27cd7b01-1515-4d4f-998e-4df0e08e44a76,00 EUR
</code></pre></div></p>
<h3 id="avro-with-kotlinx-serialized-classes">Avro with KotlinX serialized classes<a class="headerlink" href="#avro-with-kotlinx-serialized-classes" title="Permanent link">#</a></h3>
<h4 id="timings_4">Timings<a class="headerlink" href="#timings_4" title="Permanent link">#</a></h4>
<ol>
<li>Time: 82828ms</li>
<li>Time: 81669ms</li>
<li>Time: 81324ms</li>
<li>Time: 82468ms</li>
<li>Time: 82523ms</li>
</ol>
<p>Resulting in an average of 82162 ms.</p>
<h4 id="disk-usage_3">Disk usage<a class="headerlink" href="#disk-usage_3" title="Permanent link">#</a></h4>
<div class="highlight"><pre><span></span><code>-rw-r--r-- 1 root root 1000000 Jul 12 21:59 00000000000000000000.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:02 00000000000000003165.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:04 00000000000000006330.events
-rw-r--r-- 1 root root 1000000 Jul 12 22:05 00000000000000009495.events
</code></pre></div>
<p>BankAccountCreated
<div class="highlight"><pre><span></span><code>�K��X{lH27cd7b01-1515-4d4f-998e-4df0e08e44a7100,00 EUR
</code></pre></div></p>
<p>MoneyDeposited
<div class="highlight"><pre><span></span><code>�mN;�Z�ӦH27cd7b01-1515-4d4f-998e-4df0e08e44a712,00 EUR
</code></pre></div></p>
<p>MoneyWithdrawn
<div class="highlight"><pre><span></span><code>�VFtDj�xH27cd7b01-1515-4d4f-998e-4df0e08e44a76,00 EUR
</code></pre></div></p>
<h2 id="how-to-compare-anatomy-of-the-test-application">How to compare / anatomy of the test application<a class="headerlink" href="#how-to-compare-anatomy-of-the-test-application" title="Permanent link">#</a></h2>
<p>In order to make it comparable we had to use two slightly different applications. The XML, JSON and CBOR applications were using Kotlin 
Data classes for events. Those have been serialized by the corresponding Axon Serializer and sent to Axon Server. For the Avro stack we
conducted two tests: one using KotlinX Avro Serialization and another using classes created by Avro Java generator. The latter generator 
has a particular form of how classes look like (static builder, internal fields not reflecting the attributes) and therefor we created two 
versions of event classes.</p>
<p>If you look into <code>lib/</code> folder of the library you will find the following modules:</p>
<ul>
<li><code>fixture-events-manual</code>: hand-written Kotlin Data classes with KotlinX <code>Serializable</code> annotation, having the same signature as generated by Apache Avro Java generator</li>
<li><code>fixture-events-avro-java</code>: Avro specifications, used for the generation of Java classes by Apache Avro Java Maven plugin</li>
<li><code>fixture-application</code>: banking application classes (aggregate, commands, projection)</li>
<li><code>comparison-tests</code>: comparison tests</li>
</ul>
<h2 id="run-tests-on-your-own">Run tests on your own<a class="headerlink" href="#run-tests-on-your-own" title="Permanent link">#</a></h2>
<p>Every start of application will produce one run (2010 events). In our tests we re-started the application five times. </p>
<ul>
<li>XStream: start <code>bank.ComparisonApplication</code> with Spring profile <code>xstream</code></li>
<li>Jackson JSON: start <code>bank.ComparisonApplication</code> with Spring profile <code>jackson</code></li>
<li>Jackson CBOR: start <code>bank.ComparisonApplication</code> with Spring profile <code>cbor</code></li>
<li>Avro KotlinX Serialization: start <code>bank.ComparisonApplication</code> with Spring profile <code>avro</code></li>
<li>Avro Java generated classes: activate Maven profile <code>avro-java</code>, rebuild the application and start <code>bank.ComparisonApplication</code> with Spring profile <code>avro</code>  </li>
</ul>
<h2 id="additional-test-run">Additional Test run<a class="headerlink" href="#additional-test-run" title="Permanent link">#</a></h2>
<p>Macbook Pro 2021, Apple M1  Pro, 32GB. The overall performance is better, but the relative time factors are almost constant.</p>
<table>
<thead>
<tr>
<th>Format</th>
<th>Average run (ms)</th>
<th>Time Factor</th>
<th>Average Event size (bytes)</th>
<th>Size Factor</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>XStream</td>
<td>18142</td>
<td>1.703</td>
<td>21.3</td>
<td>4.253</td>
<td>No additional configuration.</td>
</tr>
<tr>
<td>Jackson JSON</td>
<td>10714</td>
<td>1.006</td>
<td>15.3</td>
<td>1.227</td>
<td>Custom Object Mapper settings for Money.</td>
</tr>
<tr>
<td>Jackson CBOR</td>
<td>10651</td>
<td>1.000</td>
<td>15.4</td>
<td>1.092</td>
<td>Custom Object Mapper settings for Money.</td>
</tr>
<tr>
<td>Avro KotlinX</td>
<td>37087</td>
<td>3.482</td>
<td>15.4 (du -s / #events)</td>
<td>1.000</td>
<td>Custom type conversions for Money.</td>
</tr>
<tr>
<td>Avro Java</td>
<td>56570</td>
<td>5.311</td>
<td>15.4</td>
<td>1.000</td>
<td>Custom type conversions for Money.</td>
</tr>
</tbody>
</table>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">October 1, 2024</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024, Holisticon AG
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://twitter.com/holisticon" target="_blank" rel="noopener" title="Holisticon on Twitter" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
    
    
    
    
    <a href="https://medium.com/holisticon-consultants/tagged/mpb" target="_blank" rel="noopener" title="Holisticon Event Sourcerers on Medium" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M180.5 74.262C80.813 74.262 0 155.633 0 256s80.819 181.738 180.5 181.738S361 356.373 361 256 280.191 74.262 180.5 74.262m288.25 10.646c-49.845 0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559c0-94.503-40.4-171.095-90.248-171.095Zm139.506 17.821c-17.526 0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top", "toc.integrate"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.525ec568.min.js"></script>
      
    
  </body>
</html>